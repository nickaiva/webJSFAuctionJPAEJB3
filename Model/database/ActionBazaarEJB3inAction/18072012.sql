CREATE TABLE AB.USERS 
(
  USER_ID VARCHAR2(40 BYTE) NOT NULL 
, USER_TYPE VARCHAR2(1 BYTE) 
, LAST_NAME VARCHAR2(255 BYTE) NOT NULL 
, USER_BILLING_ID NUMBER(19, 0) 
, BIRTH_DATE TIMESTAMP(6) 
, FIRST_NAME VARCHAR2(255 BYTE) NOT NULL 
, COMM_RATE NUMBER(19, 4) 
, MAX_ITEMS NUMBER(19, 0) 
, CREDIT_RATING NUMBER(19, 0) 
, BIDDER_STATUS VARCHAR2(255 BYTE) 
, CONSTRAINT SYS_C0021346 PRIMARY KEY 
  (
    USER_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE TABLE AB.SHIPPING_INFO 
(
  SHIPPING_ID NUMBER(19, 0) NOT NULL 
, ZIP_CODE VARCHAR2(255 BYTE) 
, STATE_CODE VARCHAR2(255 BYTE) 
, STREETNAME1 VARCHAR2(255 BYTE) NOT NULL 
, STREETNAME2 VARCHAR2(255 BYTE) NOT NULL 
, CITY VARCHAR2(255 BYTE) 
, COUNTRY VARCHAR2(255 BYTE) NOT NULL 
, CONSTRAINT SYS_C0021357 PRIMARY KEY 
  (
    SHIPPING_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE TABLE AB.ORDERS 
(
  ORDER_ID NUMBER(19, 0) NOT NULL 
, ORDER_STATUS VARCHAR2(10 BYTE) 
, ORDER_BIDDER_ID VARCHAR2(40 BYTE) 
, ORDER_BILLING_ID NUMBER(19, 0) 
, ORDER_SHIPPING_ID NUMBER(19, 0) 
, CONSTRAINT SYS_C0021348 PRIMARY KEY 
  (
    ORDER_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE TABLE AB.ITEMS 
(
  ITEM_ID NUMBER(19, 0) NOT NULL 
, ITEM_NAME VARCHAR2(255 BYTE) 
, INITIAL_PRICE NUMBER(19, 4) 
, BID_END_DATE TIMESTAMP(6) 
, CREATED_DATE TIMESTAMP(6) 
, BID_START_DATE TIMESTAMP(6) 
, ORDER_ID NUMBER(19, 0) 
, SELLER_ID VARCHAR2(40 BYTE) 
, CONSTRAINT SYS_C0021350 PRIMARY KEY 
  (
    ITEM_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE TABLE AB.CONTACT_DETAILS 
(
  CONTACT_USER_ID VARCHAR2(40 BYTE) NOT NULL 
, PHONE VARCHAR2(14 BYTE) 
, EMAIL VARCHAR2(255 BYTE) 
, ZIP_CODE VARCHAR2(255 BYTE) 
, STATE_CODE VARCHAR2(255 BYTE) 
, STREETNAME1 VARCHAR2(255 BYTE) NOT NULL 
, STREETNAME2 VARCHAR2(255 BYTE) NOT NULL 
, CITY VARCHAR2(255 BYTE) 
, COUNTRY VARCHAR2(255 BYTE) NOT NULL 
, CONSTRAINT SYS_C0021339 PRIMARY KEY 
  (
    CONTACT_USER_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE TABLE AB.CATEGORIES_ITEMS 
(
  CI_CATEGORY_ID NUMBER(19, 0) NOT NULL 
, CI_ITEM_ID NUMBER(19, 0) NOT NULL 
, CONSTRAINT SYS_C0021342 PRIMARY KEY 
  (
    CI_CATEGORY_ID 
  , CI_ITEM_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE TABLE AB.CATEGORIES 
(
  CATEGORY_ID NUMBER(19, 0) NOT NULL 
, CATEGORY_NAME VARCHAR2(255 BYTE) 
, PARENT_ID NUMBER(19, 0) 
, CREATED_BY VARCHAR2(255 BYTE) 
, CREATE_DATE DATE DEFAULT sysdate 
, CONSTRAINT SYS_C0021352 PRIMARY KEY 
  (
    CATEGORY_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE TABLE AB.BILLING_DETAILS 
(
  BILLING_ID NUMBER(19, 0) NOT NULL 
, EXPIRY_DATE VARCHAR2(4 BYTE) 
, ACCOUNT_NO VARCHAR2(20 BYTE) 
, CARD_TYPE VARCHAR2(10 BYTE) 
, SECRET_CODE VARCHAR2(5 BYTE) 
, ZIP_CD VARCHAR2(255 BYTE) 
, STATE_CD VARCHAR2(255 BYTE) 
, STREETNAME1 VARCHAR2(255 BYTE) NOT NULL 
, STREETNAME2 VARCHAR2(255 BYTE) NOT NULL 
, CITY VARCHAR2(255 BYTE) 
, COUNTRY VARCHAR2(255 BYTE) NOT NULL 
, CONSTRAINT SYS_C0021364 PRIMARY KEY 
  (
    BILLING_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE TABLE AB.BIDS 
(
  BID_ID NUMBER(19, 0) NOT NULL 
, BID_PRICE NUMBER(19, 4) 
, BID_STATUS VARCHAR2(10 BYTE) 
, OPT_LOCK NUMBER(19, 0) 
, BID_DATE DATE 
, BID_BIDDER VARCHAR2(40 BYTE) 
, BID_ITEM_ID NUMBER(19, 0) 
, CONSTRAINT SYS_C0021359 PRIMARY KEY 
  (
    BID_ID 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

ALTER TABLE AB.ORDERS
ADD CONSTRAINT FK_ORDERS_ORDER_BIDDER_ID FOREIGN KEY
(
  ORDER_BIDDER_ID 
)
REFERENCES AB.USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE AB.ORDERS
ADD CONSTRAINT FK_ORDERS_ORDER_BILLING_ID FOREIGN KEY
(
  ORDER_BILLING_ID 
)
REFERENCES AB.BILLING_DETAILS
(
  BILLING_ID 
)
ENABLE;

ALTER TABLE AB.ORDERS
ADD CONSTRAINT FK_ORDERS_ORDER_SHIPPING_ID FOREIGN KEY
(
  ORDER_SHIPPING_ID 
)
REFERENCES AB.SHIPPING_INFO
(
  SHIPPING_ID 
)
ENABLE;

ALTER TABLE AB.ITEMS
ADD CONSTRAINT FK_ITEMS_ORDER_ID FOREIGN KEY
(
  ORDER_ID 
)
REFERENCES AB.ORDERS
(
  ORDER_ID 
)
ENABLE;

ALTER TABLE AB.ITEMS
ADD CONSTRAINT FK_ITEMS_SELLER_ID FOREIGN KEY
(
  SELLER_ID 
)
REFERENCES AB.USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE AB.BIDS
ADD CONSTRAINT FK_BIDS_BID_BIDDER FOREIGN KEY
(
  BID_BIDDER 
)
REFERENCES AB.USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE AB.BIDS
ADD CONSTRAINT FK_BIDS_BID_ITEM_ID FOREIGN KEY
(
  BID_ITEM_ID 
)
REFERENCES AB.ITEMS
(
  ITEM_ID 
)
ENABLE;

COMMENT ON COLUMN AB.USERS.COMM_RATE IS 'Applies only to sellers.';

COMMENT ON COLUMN AB.USERS.MAX_ITEMS IS 'Applies only to sellers.';

COMMENT ON COLUMN AB.USERS.CREDIT_RATING IS 'Bottom creditRate is 0. Applies only to bidders.';

CREATE INDEX AB.USERS_IDX$$_087D0000 ON AB.USERS (USER_TYPE ASC, USER_ID ASC) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE INDEX AB.USERS_IDX$$_087D0003 ON AB.USERS (USER_BILLING_ID ASC) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE INDEX AB.SHIPPING_INFO_IDX$$_087D0001 ON AB.SHIPPING_INFO (SUBSTRB(COUNTRY, 1, 32) ASC, SYS_OP_OPNSIZE(COUNTRY) ASC, COUNTRY ASC, SUBSTRB(CITY, 1, 32) ASC, SYS_OP_OPNSIZE(CITY) ASC, CITY ASC, SUBSTRB(STREETNAME2, 1, 32) ASC, SYS_OP_OPNSIZE(STREETNAME2) ASC, STREETNAME2 ASC, SUBSTRB(STREETNAME1, 1, 32) ASC, SYS_OP_OPNSIZE(STREETNAME1) ASC, STREETNAME1 ASC, SUBSTRB(STATE_CODE, 1, 32) ASC, SYS_OP_OPNSIZE(STATE_CODE) ASC, STATE_CODE ASC, SUBSTRB(ZIP_CODE, 1, 32) ASC, SYS_OP_OPNSIZE(ZIP_CODE) ASC, ZIP_CODE ASC, SHIPPING_ID ASC, SYS_OP_OPNSIZE(SHIPPING_ID) ASC) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE INDEX AB.ORDERS_IDX$$_087D0002 ON AB.ORDERS (ORDER_BIDDER_ID ASC) 
LOGGING 
TABLESPACE "USERS" 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
);

CREATE SEQUENCE AB.SHIPPING_SEQ INCREMENT BY 50 MAXVALUE 9999999999999999999999999999 MINVALUE 1 CACHE 20;

CREATE SEQUENCE AB.ORDER_SEQUENCE INCREMENT BY 20 MAXVALUE 9999999999999999999999999999 MINVALUE 1 CACHE 20;

CREATE SEQUENCE AB.ITEM_SEQUENCE INCREMENT BY 50 MAXVALUE 9999999999999999999999999999 MINVALUE 1 CACHE 20;

CREATE SEQUENCE AB.CATEGORY_SEQ INCREMENT BY 50 MAXVALUE 9999999999999999999999999999 MINVALUE 1 CACHE 20;

CREATE SEQUENCE AB.BILLING_SEQUENCE INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 CACHE 20;

CREATE SEQUENCE AB.BID_SEQUENCE INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 CACHE 20;
